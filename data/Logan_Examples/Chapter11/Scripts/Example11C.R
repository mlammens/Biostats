###################################################
### chunk number 1: pg 303
###################################################
ph <- read.table('ph.csv', header=T, sep=',')


###################################################
### chunk number 2: pg 304
###################################################
library(nlme)
ph.agg <- gsummary(ph, groups=ph$SIRE)
boxplot(PH~DAM, ph.agg)


###################################################
### chunk number 3: pg 304
###################################################
boxplot(PH~DAM:SIRE, ph)


###################################################
### chunk number 4: pg 305
###################################################
replications(PH ~ DAM + SIRE,data=ph)
library(biology)
is.balanced(PH ~ DAM + SIRE,data=ph)


###################################################
### chunk number 5: pg 305
###################################################
ph.aov <- aov(PH~DAM, ph.agg)
anova(ph.aov)


###################################################
### chunk number 6: pg 306
###################################################
ph.aov1<-aov(PH~DAM+SIRE, data=ph)
anova(ph.aov1)


###################################################
### chunk number 7: pg 307
###################################################
library(lme4)
ph.lmer <- lmer(PH~1+(1|DAM/SIRE), ph)
summary(ph.lmer)


###################################################
### chunk number 8: pg 308
###################################################
library(languageR)
pvals.fnc(ph.lmer)
